<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farm Products</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        header {
            background: #4CAF50;
            color: white;
            text-align: center;
            padding: 1em 0;
        }
        footer {
            background: #333;
            color: white;
            text-align: center;
            padding: 1em 0;
            position: absolute;
            bottom: 0;
            width: 100%;
        }
        table {
            width: 70%;
            margin: 20px auto;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        .sidebar {
            position: fixed;
            right: 0;
            width: 200px;
            background: #f9f9f9;
            padding: 15px;
            box-shadow: -2px 0 5px rgba(0,0,0,0.1);
        }
        .contact-form {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border: 1px solid #ccc;
            z-index: 10;
        }
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 5;
        }
    </style>
    <script>
    
        
        function toggleContactForm() {
            const form = document.getElementById('contact-form');
            const overlay = document.getElementById('overlay');
            form.style.display = form.style.display === 'block' ? 'none' : 'block';
            overlay.style.display = overlay.style.display === 'block' ? 'none' : 'block';
        }

        

    function showPosition(position) {
        if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                alert("Geolocation is not supported by this browser.");
            }
        
        const userLat = position.coords.latitude;
        const userLon = position.coords.longitude;

        const farms = document.querySelectorAll('#farmTable tr');

        farms.forEach(farm => {
            const farmLat = parseFloat(farm.getAttribute('data-lat'));
            const farmLon = parseFloat(farm.getAttribute('data-lon'));
            const distance = calculateDistance(userLat, userLon, farmLat, farmLon);
            console.log(distance);
            farm.querySelector('.distance').textContent = distance.toFixed(2) + ' miles';
        });

        console.log("Your location: Latitude: " + userLat + ", Longitude: " + userLon);
    }

    function calculateDistance(lat1, lon1, lat2, lon2) {
        const R = 3958.8; // Radius of the Earth in miles
        const dLat = (lat2 - lat1) * (Math.PI / 180);
        const dLon = (lon2 - lon1) * (Math.PI / 180);
        const a = 
            Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(lat1 * (Math.PI / 180)) * Math.cos(lat2 * (Math.PI / 180)) *
            Math.sin(dLon/2) * Math.sin(dLon/2); 
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
        return R * c; // Distance in miles
    }

    function showError(error) {
        switch(error.code) {
            case error.PERMISSION_DENIED:
                alert("User denied the request for Geolocation.");
                break;
            case error.POSITION_UNAVAILABLE:
                alert("Location information is unavailable.");
                break;
            case error.TIMEOUT:
                alert("The request to get user location timed out.");
                break;
            case error.UNKNOWN_ERROR:
                alert("An unknown error occurred.");
                break;
        }
    }
    </script>
</head>
<body>

<header>
    <h1>Buy from Farmers</h1>
</header>
<h1>Farm Locator</h1>
<button onclick="showPosition()">Locate Me</button>
<table>
    <thead>
    <tr>
        <th>Eggs</th>
        <th>Chicken</th>
        <th>Duck</th>
        <th>Beef</th>
        <th>Lamb</th>
        <th>Turkey</th>
        <th>Vegetables</th>
        <th>Honey</th>
        <th>Milk</th>
        <th>Store?</th>
        <th>Online Order?</th>
        <th>Farm Name</th>
        <th>Address</th>
        <th>Distance from Your Location</th>
    </tr>
        </thead>
    <tbody id="farmTable">
    <tr data-lat="43.485060" data-lon="-80.755850">
        <td>y</td>
        <td>y</td>
        <td>y</td>
        <td>y</td>
        <td>y</td>
        <td>y</td>
        <td>y</td>
        <td>y</td>
        <td>y</td>
        <td>5</td>
        <td>8</td>
        <td>Bast Farm</td>
        <td>1400 Greenwood Hill Road, Wellesley, Ontario n0b2t0</td>
        <td class="distance"></td>
    </tr>
    </tbody>
    <!-- More rows can be added here -->
</table>

<button onclick="toggleContactForm()">Contact Us</button>

<div class="sidebar">
    <h2>Links</h2>
    <ul>
        <li><a href="#">Home</a></li>
        <li><a href="#">About Us</a></li>
        <li><a href="#">Products</a></li>
        <li><a href="#">FAQ</a></li>
        <li><a href="#">Support</a></li>
    </ul>
</div>

<div id="overlay" class="overlay" onclick="toggleContactForm()"></div>
<div id="contact-form" class="contact-form">
    <h2>Contact Us</h2>
    <form>
        <label for="name">Name:</label><br>
        <input type="text" id="name" name="name"><br><br>
        <label for="email">Email:</label><br>
        <input type="email" id="email" name="email"><br><br>
        <label for="message">Message:</label><br>
        <textarea id="message" name="message"></textarea><br><br>
        <input type="submit" value="Submit">
    </form>
    <button onclick="toggleContactForm()">Close</button>
</div>

<footer>
    <p>&copy; 2024 Farm Products. All rights reserved.</p>
</footer>

</body>
</html>
